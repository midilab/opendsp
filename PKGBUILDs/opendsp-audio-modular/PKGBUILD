# Maintainer: Midilab <contact@midilab.co>

pkgname=opendsp-audio-modular
pkgver=0.1
pkgrel=1
pkgdesc='OpenDSP Audio Modular meta package'
arch=(any)
url='http://midilab.co/opendspd'
license=('GPL')
depends=(carla cadence bchoppr beatslash-lv2 ecasound \
        qtractor milkytracker giada luppp mixxx xwax lmms hydrogen \
        blop.lv2 bsequencer bshapr bslizr calf deteriorate-lv2 drumgizmo \
        drumkv1 element eteroj.lv2 fomp.lv2 guitarix gxplugins.lv2 \
        helm-synth infamousplugins ir.lv2 jalv lilv \
        liquidsfz lsp-plugins lv2 lv2file lv2lint lvtk mda.lv2\
        mephisto.lv2 midi_matrix.lv2 midimsg-lv2 moony.lv2 \
        padthv1 qmidiarp samplv1 setbfree sfizz sratom \
        suil synthv1 vm.lv2 x42-plugins xmonk.lv2 zynaddsubfx \
        raul ingen distrho-lv2 \
        non-timeline non-mixer non-session-manager non-sequencer klystrack \
        dpf-plugins-lv2-git swh-lv2 zamplugins \
        drmr-falktx-git sooperlooper-lv2-plugin)

prepare() 
{
  cd "${srcdir}"
}

build() 
{
  cd "${srcdir}"
}

package()
{
  cd "${srcdir}"
  # symlink our apps that need realtime rw access
  paths=("/home/opendsp/.config/falkTX:/home/opendsp/data/app/carla/" "/home/opendsp/.config/SunVox:/home/opendsp/data/app/sunvox/")
  for path in "${paths[@]}"; do
      # split by `:`
      data=($(echo $path | tr ":" "\n"))
      source=${data[0]}
      destination=${data[1]}
      
      # the destination is a file or a dir?
      if ! [ -z ${destination##*/} ]
        # the destinatoin is a file
        desitnation=${destination%/*}
      fi

      mkdir -p $pkgdir/${source%/*}
      mkdir -p $pkgdir/$destination

      ln -s $source $pkgdir/$destination
  done
}
